apiVersion: v1
kind: Service
metadata:
  name: my-app-router-service # This is the stable, unchanging service name. External traffic always hits this service.
  labels:
    app: my-app
    role: router # A specific label to easily identify this router service.
spec:
  selector:
    # This selector is the key to blue-green switching.
    # It will be patched by the Kustomize overlays (blue or green)
    # to dynamically point to the currently active deployment's pods.
    app: my-app
    version: initial-placeholder # This will be replaced by 'blue' or 'green' by the overlays.
  ports:
  - protocol: TCP
    port: 80 # Port for the router service
    targetPort: 80 # Target port on the selected application pods